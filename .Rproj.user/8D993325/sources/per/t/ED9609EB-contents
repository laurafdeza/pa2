---
title: "pa2"
output: github_document
---

Comparison of lexical stress acoustic correlates in phonemically equally sounding words in Spanish. Example: "busco - buscó"

```{r include=FALSE}
# include = FALSE prevents code and results from appearing in the finished file. R Markdown still runs the code in the chunk, and the results can be used by other chunks. 
# echo = FALSE prevents code, but not the results from appearing in the finished file. This is a useful way to embed figures.
# message = FALSE prevents messages that are generated by code from appearing in the finished file. 
# warning = FALSE prevents warnings that are generated by code from appearing in the finished. 
# fig.cap = "..." adds a caption to graphical results. 
# See the R Markdown Reference Guide ⧉ for a complete list of knitr chunk options. 

```



```{r include=FALSE}
# load packages
library(ggpubr)
library(tidyverse)

# read data
lex_ac <- read_csv("./data/data.csv")

# split info column into item and position of lexical stress:
# 1 = paroxytone
# 2 = oxytone
lex_ac_clean <- separate(data = lex_ac,
         col = info,
         into = c("item", "lex_stress"),
         sep = "_") %>%
  rename(., duration = durationV)

lex_ac_clean[lex_ac_clean$lex_stress == 1, "lex_stress"] <- "paroxytone"
lex_ac_clean[lex_ac_clean$lex_stress == 2, "lex_stress"] <- "oxytone"
```

```{r echo=FALSE}
# calculate and plot average duration, f0 and intensity as a function of lexical stress
stats <- lex_ac_clean %>%
  group_by(lex_stress) %>%
  summarize(mean_Hz = mean(f0),
            mean_dB = mean(int),
            mean_ms = mean(duration))

knitr::kable(stats)

Hz <- ggplot(stats, aes(lex_stress, mean_Hz)) +
        geom_point(color="orange") +
        theme(axis.title.x=element_blank(),
              axis.text.x=element_blank(),
              axis.ticks.x=element_blank()) +
        labs(y = "Mean F0 \n(Hz)")

dB <- ggplot(stats, aes(lex_stress, mean_dB)) +
        geom_point(color="green") +
#        geom_text() +
        theme(axis.title.x=element_blank(),
              axis.text.x=element_blank(),
              axis.ticks.x=element_blank()) +
        labs(y = "Mean intensity \n(dB)")

ms <- ggplot(stats, aes(lex_stress, mean_ms)) +
        geom_point(color="purple") +
        labs(x = "Position of lexical stress", y = "Mean duration \n(ms)") +
        scale_x_discrete(labels=c("oxytone" = "Oxytone", "paroxytone" = "Paroxytone"))
        

fig <- ggarrange(Hz, dB, ms, ncol = 1, nrow = 3)

annotate_figure(fig, top = text_grob("Mean Values of Lexical Stress Acoustic Correlates in Spanish"))


```


